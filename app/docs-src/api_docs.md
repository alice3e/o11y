# üîß API Documentation - Product Store

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ REST API –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã Product Store —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

## üåê –û–±–∑–æ—Ä API

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å 4 –æ—Å–Ω–æ–≤–Ω—ã–º–∏ API —Å–µ—Ä–≤–∏—Å–∞–º–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –≤—Ö–æ–¥–∞ Nginx:

| –°–µ—Ä–≤–∏—Å | –ë–∞–∑–æ–≤—ã–π URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------------|----------|
| **Backend API** | `/api/*` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –∫–∞—Ç–∞–ª–æ–≥–æ–º |
| **Cart API** | `/cart-api/*` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–æ–π –ø–æ–∫—É–ø–æ–∫ |
| **Order API** | `/order-api/*` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ |
| **User API** | `/user-api/*` | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ |

**–ë–∞–∑–æ–≤—ã–π URL –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:** `http://localhost/`

## üìã –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üöÄ Swagger UI - –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**URL:** [http://localhost/swagger/](http://localhost/swagger/)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤** –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π** (admin/user) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

### üîê –î–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:

| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ü–∞—Ä–æ–ª—å | –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|--------|------|----------|
| `swagger_admin` | `admin123` | üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º |
| `swagger_user` | `password123` | üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø |

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥:** Swagger UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è –ø–æ–¥ `swagger_admin`

---

## üè™ Backend API (`/api/*`)

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –∫–∞—Ç–∞–ª–æ–≥–æ–º –º–∞–≥–∞–∑–∏–Ω–∞**

### üì¶ Products API

#### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤

```http
GET /api/products/                    # –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ (—Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –¥–æ—Å—Ç—É–ø–∞)
GET /api/products/{product_id}        # –î–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
GET /api/products/categories/list     # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
GET /api/products/by-category/{cat}   # –¢–æ–≤–∞—Ä—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```

**–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º:**
- üë§ **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑–∞—Ç—å `category` –ø–∞—Ä–∞–º–µ—Ç—Ä
- üëë **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã**: –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- üåê **–ë–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**: —Ç–æ–ª—å–∫–æ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
# –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è)
GET /api/products/?category=–§—Ä—É–∫—Ç—ã&limit=10&skip=0
Authorization: Bearer JWT_TOKEN

# –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞)
GET /api/products/?limit=20&sort_by=price&sort_order=desc
Authorization: Bearer JWT_TOKEN
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è non-admin)
- `skip` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞ (offset)
- `limit` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ (1-100)
- `sort_by` - –ø–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (`name` –∏–ª–∏ `price`)
- `sort_order` - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (`asc` –∏–ª–∏ `desc`)
- `min_price` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `max_price` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)

```http
POST   /api/products/                 # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
PUT    /api/products/{product_id}     # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
DELETE /api/products/{product_id}     # –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
```

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:**
```json
POST /api/products/
Authorization: Bearer ADMIN_JWT_TOKEN
Content-Type: application/json

{
  "name": "–Ø–±–ª–æ–∫–∏ –ì–∞–ª–∞",
  "category": "–§—Ä—É–∫—Ç—ã",
  "price": 89.99,
  "stock_count": 150,
  "description": "–°–ª–∞–¥–∫–∏–µ —è–±–ª–æ–∫–∏ —Å–æ—Ä—Ç–∞ –ì–∞–ª–∞",
  "manufacturer": "–°–∞–¥—ã –†–æ—Å—Å–∏–∏"
}
```

### üîß System API

```http
GET /system/health                    # Health check + —Å—Ç–∞—Ç—É—Å –ë–î
GET /                                 # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
GET /metrics                          # Prometheus –º–µ—Ç—Ä–∏–∫–∏
```

---

## üõí Cart API (`/cart-api/*`)

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–æ–π –ø–æ–∫—É–ø–æ–∫ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –æ—Å—Ç–∞—Ç–∫–æ–≤**

### üõçÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ—Ä–∑–∏–Ω–æ–π

```http
GET    /cart/                         # –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã
POST   /cart/items                    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
PUT    /cart/items/{item_id}          # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
DELETE /cart/items/{item_id}          # –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
DELETE /cart/                         # –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
POST   /cart/checkout                 # –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
```

**–ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É:**
```json
POST /cart-api/cart/items
Authorization: Bearer JWT_TOKEN
Content-Type: application/json

{
  "product_id": "f767c2cb-215d-469e-a3be-c6e40a6cf47f",
  "quantity": 2
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "id": "item-uuid",
  "product_id": "f767c2cb-215d-469e-a3be-c6e40a6cf47f",
  "name": "–Ø–±–ª–æ–∫–∏ –ì–∞–ª–∞",
  "price": 89.99,
  "quantity": 2,
  "total_price": 179.98
}
```

### üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```http
POST /products/{product_id}/view      # –ó–∞–ø–∏—Å—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–≤–∞—Ä–∞
GET  /products/recent-views           # –ù–µ–¥–∞–≤–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
GET  /carts/                          # –í—Å–µ –∫–æ—Ä–∑–∏–Ω—ã (admin only)
```

### üîÑ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ:**
- –°–Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫ –ø–æ `item_id` (UUID —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ—Ä–∑–∏–Ω—ã)
- –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–∏—Å–∫ –ø–æ `product_id` (UUID —Ç–æ–≤–∞—Ä–∞)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ —Ç–æ–≤–∞—Ä–∞ –ø–æ `product_id`

**–í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

---

## üì¶ Order API (`/order-api/*`)

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–æ–≤**

### üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏

```http
GET    /orders/                       # –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST   /orders/                       # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–∏–∑ Cart API)
GET    /orders/{order_id}             # –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
PUT    /orders/{order_id}/cancel      # –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞
GET    /orders/statuses/list          # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
```

### üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```http
PUT /orders/{order_id}/status         # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ (admin only)
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤:**
- `CREATED` - –°–æ–∑–¥–∞–Ω
- `PROCESSING` - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è  
- `SHIPPING` - –î–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è
- `DELIVERED` - –î–æ—Å—Ç–∞–≤–ª–µ–Ω
- `CANCELLED` - –û—Ç–º–µ–Ω–µ–Ω

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–∫–∞–∑–∞:**
```
CREATED ‚Üí PROCESSING (5 —Å–µ–∫) ‚Üí SHIPPING (5 —Å–µ–∫) ‚Üí DELIVERED (60-300 —Å–µ–∫)
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–º–µ–Ω—ã:**
- `CREATED`, `PROCESSING` - –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –∞–¥–º–∏–Ω
- `SHIPPING` - –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω
- `DELIVERED`, `CANCELLED` - –æ—Ç–º–µ–Ω–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:**
```json
POST /order-api/orders/
Authorization: Bearer JWT_TOKEN
Content-Type: application/json

{
  "items": [
    {
      "product_id": "product-uuid",
      "name": "–Ø–±–ª–æ–∫–∏ –ì–∞–ª–∞",
      "price": 89.99,
      "quantity": 2
    }
  ],
  "total": 179.98
}
```

---

## üë§ User API (`/user-api/*`)

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```http
POST /users/register                  # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST /token                           # –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
GET  /users/me                        # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PUT  /users/me                        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
```json
POST /user-api/users/register
Content-Type: application/json

{
  "username": "newuser",
  "full_name": "New User",
  "phone": "+7 (999) 123-45-67",
  "password": "password123"
}
```

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:**
```http
POST /user-api/token
Content-Type: application/x-www-form-urlencoded

username=newuser&password=password123
```

**–û—Ç–≤–µ—Ç —Å —Ç–æ–∫–µ–Ω–æ–º:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

### üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
GET  /users/me/profile                # –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
GET  /users/me/orders                 # –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
GET  /users/me/cart                   # –¢–µ–∫—É—â–∞—è –∫–æ—Ä–∑–∏–Ω–∞
POST /users/me/orders                 # –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
GET  /users/me/total-spent            # –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫
```

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è:**
```json
GET /user-api/users/me/profile
Authorization: Bearer JWT_TOKEN

{
  "username": "newuser",
  "full_name": "New User",
  "phone": "+7 (999) 123-45-67",
  "id": "00000001",
  "created_at": "2025-07-25T19:00:00",
  "total_spent": 359.96,
  "is_admin": false,
  "current_cart_total": 179.98,
  "orders": [
    {
      "id": "order-uuid",
      "status": "DELIVERED",
      "total": 179.98,
      "created_at": "2025-07-25T18:00:00"
    }
  ]
}
```

### üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

```http
GET  /                                # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
GET  /health                          # Health check
POST /users/notify/order-status       # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç Order Service
GET  /swagger-admin-token             # –¢–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∞ –¥–ª—è Swagger UI
```

---

## üîê –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### üé´ JWT –¢–æ–∫–µ–Ω—ã

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: HS256
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: 30 –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á**: `supersecretkey123` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ ENV)

**Payload —Ç–æ–∫–µ–Ω–∞:**
```json
{
  "sub": "username",           # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  "is_admin": true,           # –§–ª–∞–≥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
  "exp": 1690311600           # –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è (Unix timestamp)
}
```

### üõ°Ô∏è –ú–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### 1. Authorization Header (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥)
```http
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### 2. X-User-ID Header (–¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤)
```http
X-User-ID: username
```

#### 3. Admin Header (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
```http
admin: true
```

### üëë –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏:**
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã**: username –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `admin_` –∏–ª–∏ —Ñ–ª–∞–≥ `is_admin: true`
- **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**

| –û–ø–µ—Ä–∞—Ü–∏—è | –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä |
|----------|---------------------|---------------|
| –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤ | –¢–æ–ª—å–∫–æ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º | –í—Å–µ —Ç–æ–≤–∞—Ä—ã |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ | ‚ùå | ‚úÖ |
| –°–≤–æ—è –∫–æ—Ä–∑–∏–Ω–∞ | ‚úÖ | ‚úÖ |
| –í—Å–µ –∫–æ—Ä–∑–∏–Ω—ã | ‚ùå | ‚úÖ |
| –°–≤–æ–∏ –∑–∞–∫–∞–∑—ã | ‚úÖ | ‚úÖ |
| –í—Å–µ –∑–∞–∫–∞–∑—ã | ‚ùå | ‚úÖ |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ | ‚ùå | ‚úÖ |

---

## üîÑ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üõí –ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–∫—É–ø–∫–∏

```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST http://localhost/user-api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "customer1",
    "full_name": "Customer One", 
    "phone": "+7 (999) 123-45-67",
    "password": "password123"
  }'

# 2. –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
TOKEN=$(curl -X POST http://localhost/user-api/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=customer1&password=password123" \
  | jq -r '.access_token')

# 3. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
curl -X GET "http://localhost/api/products/?category=–§—Ä—É–∫—Ç—ã&limit=10" \
  -H "Authorization: Bearer $TOKEN"

# 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
curl -X POST http://localhost/cart-api/cart/items \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "product_id": "PRODUCT_UUID",
    "quantity": 2
  }'

# 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã
curl -X GET http://localhost/cart-api/cart/ \
  -H "Authorization: Bearer $TOKEN"

# 6. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
curl -X POST http://localhost/user-api/users/me/orders \
  -H "Authorization: Bearer $TOKEN"

# 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
curl -X GET http://localhost/user-api/users/me/orders \
  -H "Authorization: Bearer $TOKEN"
```

### üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
ADMIN_TOKEN=$(curl -X POST http://localhost/user-api/token \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=swagger_admin&password=admin123" \
  | jq -r '.access_token')

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
curl -X GET "http://localhost/api/products/?limit=20&sort_by=price" \
  -H "Authorization: Bearer $ADMIN_TOKEN"

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
curl -X POST http://localhost/api/products/ \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $ADMIN_TOKEN" \
  -d '{
    "name": "–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä",
    "category": "–ö–∞—Ç–µ–≥–æ—Ä–∏—è",
    "price": 99.99,
    "stock_count": 100,
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
  }'

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–æ—Ä–∑–∏–Ω
curl -X GET http://localhost/cart-api/carts/ \
  -H "admin: true"

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
curl -X PUT http://localhost/order-api/orders/ORDER_ID/status \
  -H "admin: true" \
  -H "Content-Type: application/json" \
  -d '"DELIVERED"'
```

---

## üìä –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ HTTP

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|-----|----------|----------------------|
| `200 OK` | –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å | GET –∑–∞–ø—Ä–æ—Å—ã, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| `201 Created` | –†–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω | POST —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `204 No Content` | –£—Å–ø–µ—à–Ω–æ, –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ | DELETE –æ–ø–µ—Ä–∞—Ü–∏–∏ |

### ‚ö†Ô∏è –û—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ (4xx)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|-----|----------|---------|
| `400 Bad Request` | –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ | –ù–µ–≤–µ—Ä–Ω—ã–π JSON, –≤–∞–ª–∏–¥–∞—Ü–∏—è |
| `401 Unauthorized` | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç JWT —Ç–æ–∫–µ–Ω |
| `403 Forbidden` | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ | –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä |
| `404 Not Found` | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç–æ–≤–∞—Ä –∏–ª–∏ –∑–∞–∫–∞–∑ |

### ‚ùå –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (5xx)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
|-----|----------|---------|
| `500 Internal Server Error` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ | –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ —Å–µ—Ä–≤–∏—Å–∞ |
| `503 Service Unavailable` | –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω |

### üìù –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

```json
{
  "detail": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "error_code": "OPTIONAL_ERROR_CODE",
  "timestamp": "2025-07-25T19:00:00Z"
}
```

**–ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫:**
```json
// 403 Forbidden - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
{
  "detail": "–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä 'category'."
}

// 400 Bad Request - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ
{
  "detail": "Not enough items in stock"
}

// 404 Not Found - —Ç–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
{
  "detail": "Product with id f767c2cb-215d-469e-a3be-c6e40a6cf47f not found"
}
```

---

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìã Postman Collection

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å Postman –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏:

1. **Environment Variables:**
   ```
   baseUrl: http://localhost
   userToken: {{–ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ login –∑–∞–ø—Ä–æ—Å–∞}}
   adminToken: {{–ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ admin login –∑–∞–ø—Ä–æ—Å–∞}}
   ```

2. **Pre-request Scripts –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
   ```javascript
   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   pm.sendRequest({
     url: pm.environment.get("baseUrl") + "/user-api/token",
     method: 'POST',
     header: {'Content-Type': 'application/x-www-form-urlencoded'},
     body: {
       mode: 'urlencoded',
       urlencoded: [
         {key: 'username', value: 'swagger_user'},
         {key: 'password', value: 'password123'}
       ]
     }
   }, function(err, res) {
     if (res.json().access_token) {
       pm.environment.set("userToken", res.json().access_token);
     }
   });
   ```

### üß™ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è smoke testing:**
```bash
#!/bin/bash
# test_api.sh

BASE_URL="http://localhost"

# Health checks
curl -f "$BASE_URL/api/system/health" || exit 1
curl -f "$BASE_URL/cart-api/health" || exit 1  
curl -f "$BASE_URL/order-api/health" || exit 1
curl -f "$BASE_URL/user-api/health" || exit 1

echo "‚úÖ All services are healthy"

# User registration and authentication
TOKEN=$(curl -s -X POST "$BASE_URL/user-api/users/register" \
  -H "Content-Type: application/json" \
  -d '{"username":"test_user","full_name":"Test User","phone":"+7999","password":"test123"}' \
  && curl -s -X POST "$BASE_URL/user-api/token" \
  -d "username=test_user&password=test123" | jq -r '.access_token')

echo "‚úÖ User registered and authenticated"

# Test protected endpoints
curl -f -H "Authorization: Bearer $TOKEN" "$BASE_URL/api/products/?category=–§—Ä—É–∫—Ç—ã" || exit 1
curl -f -H "Authorization: Bearer $TOKEN" "$BASE_URL/cart-api/cart/" || exit 1

echo "‚úÖ Protected endpoints accessible"
echo "üéâ All tests passed!"
```

---

**üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- **[Swagger UI](http://localhost/swagger/)** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **[Grafana](http://localhost:3000)** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
- **[Prometheus](http://localhost:9090)** - –º–µ—Ç—Ä–∏–∫–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
